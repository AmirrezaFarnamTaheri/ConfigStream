<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="View detailed analytics and trends for our free VPN configurations, including protocol distribution and geographic data.">
    <title>Analytics - ConfigStream</title>
    <link rel="icon" type="image/svg+xml" href="assets/svg/favicon.svg">
    <link rel="alternate icon" href="assets/images/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="assets/images/apple-touch-icon.png">
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="stylesheet" href="assets/css/state-manager.css">
    <link rel="stylesheet" href="assets/css/error-handler.css">
    <link rel="stylesheet" href="assets/css/loading.css">
    <link rel="stylesheet" href="assets/css/header-animation.css">
    <link rel="stylesheet" href="assets/css/logo-animations.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body>
    <!-- Loading Screen -->
    <div id="loading-screen" class="loading-screen" role="status" aria-live="polite">
      <div class="loading-container">
        <!-- Logo Animation -->
        <div class="loading-logo">
          <object data="assets/svg/logo-loading.svg" type="image/svg+xml" aria-label="ConfigStream Loading">
            <img src="assets/svg/favicon.svg" alt="ConfigStream Logo" />
          </object>
        </div>
        
        <!-- Loading Message -->
        <div class="loading-message">
          <p class="loading-text" id="loadingText">Fetching latest configurations...</p>
          <div class="loading-dots">
            <span class="dot"></span>
            <span class="dot"></span>
            <span class="dot"></span>
          </div>
        </div>
        
        <!-- Progress hint -->
        <p class="loading-hint" id="loadingHint">Taking longer than usual...</p>
      </div>
      
      <!-- Screen reader -->
      <span class="sr-only" aria-atomic="true" id="loadingAnnounce">Loading content, please wait</span>
    </div>
    <div class="nav-overlay"></div>
    <header class="header">
        <div class="container">
            <div class="header-logo-wrapper">
              <svg width="50" height="50" viewBox="0 0 50 50" fill="none" xmlns="http://www.w3.org/2000/svg" class="header-logo" id="headerLogo" aria-label="ConfigStream Logo">
                <defs>
                    <linearGradient id="logo-gradient-header" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" stop-color="var(--brand-primary)">
                            <animate attributeName="stop-color" values="var(--brand-primary);var(--brand-tertiary);var(--brand-secondary);var(--brand-primary)" dur="8s" repeatCount="indefinite"></animate>
                        </stop>
                        <stop offset="50%" stop-color="var(--brand-tertiary)">
                            <animate attributeName="stop-color" values="var(--brand-tertiary);var(--brand-secondary);var(--brand-primary);var(--brand-tertiary)" dur="8s" repeatCount="indefinite"></animate>
                        </stop>
                        <stop offset="100%" stop-color="var(--brand-secondary)">
                            <animate attributeName="stop-color" values="var(--brand-secondary);var(--brand-primary);var(--brand-tertiary);var(--brand-secondary)" dur="8s" repeatCount="indefinite"></animate>
                        </stop>
                    </linearGradient>
                    <filter id="logo-shadow-header" x="-30%" y="-30%" width="160%" height="160%">
                        <feDropShadow dx="1" dy="2" stdDeviation="3.5" flood-color="var(--brand-secondary)" flood-opacity="0.25"/>
                    </filter>
                </defs>
                <g filter="url(#logo-shadow-header)">
                    <path d="M33 8C40.1797 8 46 13.8203 46 21C46 28.1797 40.1797 34 33 34H17" stroke="url(#logo-gradient-header)" stroke-width="5" stroke-linecap="round" stroke-linejoin="round" fill="none">
                        <animate attributeName="d" values="M33 8C40.1797 8 46 13.8203 46 21C46 28.1797 40.1797 34 33 34H17;M33 10C40.1797 10 46 15.8203 46 23C46 30.1797 40.1797 36 33 36H17;M33 8C40.1797 8 46 13.8203 46 21C46 28.1797 40.1797 34 33 34H17" dur="8s" repeatCount="indefinite" />
                    </path>
                    <path d="M17 42C9.8203 42 4 36.1797 4 29C4 21.8203 9.8203 16 17 16H33" stroke="url(#logo-gradient-header)" stroke-width="4" stroke-linecap="round" stroke-linejoin="round" fill="none">
                        <animate attributeName="d" values="M17 42C9.8203 42 4 36.1797 4 29C4 21.8203 9.8203 16 17 16H33;M17 40C9.8203 40 4 34.1797 4 27C4 19.8203 9.8203 14 17 14H33;M17 42C9.8203 42 4 36.1797 4 29C4 21.8203 9.8203 16 17 16H33" dur="8s" repeatCount="indefinite" />
                    </path>
                </g>
              </svg>
              <span class="header-logo-text">ConfigStream</span>
            </div>
            <nav class="nav" id="main-nav" aria-label="Main navigation">
                <a href="index.html" class="nav-link">Home</a>
                <a href="proxies.html" class="nav-link">Proxy List</a>
                <a href="statistics.html" class="nav-link">Analytics</a>
            </nav>
            <div class="header-actions">
                <button id="theme-switcher" class="theme-btn" aria-label="Toggle theme">
                    <div class="theme-btn-inner">
                        <i data-feather="moon" class="moon-icon"></i>
                        <i data-feather="sun" class="sun-icon"></i>
                    </div>
                </button>
                <a href="https://github.com/AmirrezaFarnamTaheri/ConfigStream" class="github-btn" target="_blank" rel="noopener noreferrer" aria-label="View on GitHub">
                    <i data-feather="github"></i>
                </a>
                <button class="mobile-nav-toggle" id="mobile-nav-toggle" aria-label="Open navigation menu" aria-expanded="false" aria-controls="main-nav">
                    <i data-feather="menu" class="menu-icon"></i>
                    <i data-feather="x" class="close-icon"></i>
                </button>
            </div>
        </div>
    </header>

    <main>
        <div class="container">
            <!-- Hero Section -->
            <section class="analytics-hero">
                <div class="analytics-hero-content">
                    <h1>Analytics Dashboard</h1>
                    <p class="subtitle">Real-time insights into your global proxy network performance and distribution</p>
                    <div class="analytics-meta">
                        <div class="meta-item">
                            <i data-feather="clock"></i>
                            <span>Last Updated: <strong id="lastUpdated">Loading...</strong></span>
                        </div>
                        <div class="meta-actions">
                            <button id="refreshData" class="btn btn-secondary btn-icon" aria-label="Refresh data" title="Refresh data">
                                <i data-feather="refresh-cw"></i>
                            </button>
                            <button id="exportData" class="btn btn-secondary btn-icon" aria-label="Export data" title="Export analytics data">
                                <i data-feather="download"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Key Metrics Grid -->
            <section class="metrics-grid" style="--delay: 0.1s;">
                <div class="metric-card metric-primary">
                    <div class="metric-icon">
                        <i data-feather="server"></i>
                    </div>
                    <div class="metric-content">
                        <div class="metric-label">Total Proxies</div>
                        <div id="totalProxies" class="metric-value loading">0</div>
                        <div id="totalProxiesTrend" class="metric-trend">
                            <span class="trend-indicator">—</span>
                        </div>
                    </div>
                </div>

                <div class="metric-card metric-success">
                    <div class="metric-icon">
                        <i data-feather="check-circle"></i>
                    </div>
                    <div class="metric-content">
                        <div class="metric-label">Active Proxies</div>
                        <div id="workingProxies" class="metric-value loading">0</div>
                        <div id="workingProxiesPercent" class="metric-trend">
                            <span class="trend-indicator">—</span>
                        </div>
                    </div>
                </div>

                <div class="metric-card metric-info">
                    <div class="metric-icon">
                        <i data-feather="globe"></i>
                    </div>
                    <div class="metric-content">
                        <div class="metric-label">Countries</div>
                        <div id="totalCountries" class="metric-value loading">0</div>
                        <div class="metric-trend">
                            <span class="trend-indicator">Global Coverage</span>
                        </div>
                    </div>
                </div>

                <div class="metric-card metric-warning">
                    <div class="metric-icon">
                        <i data-feather="zap"></i>
                    </div>
                    <div class="metric-content">
                        <div class="metric-label">Avg Latency</div>
                        <div id="avgLatency" class="metric-value loading">0<span class="metric-unit">ms</span></div>
                        <div id="avgLatencyTrend" class="metric-trend">
                            <span class="trend-indicator">—</span>
                        </div>
                    </div>
                </div>

                <div class="metric-card metric-accent">
                    <div class="metric-icon">
                        <i data-feather="activity"></i>
                    </div>
                    <div class="metric-content">
                        <div class="metric-label">Protocols</div>
                        <div id="totalProtocols" class="metric-value loading">0</div>
                        <div class="metric-trend">
                            <span class="trend-indicator">Types Available</span>
                        </div>
                    </div>
                </div>

                <div class="metric-card metric-special">
                    <div class="metric-icon">
                        <i data-feather="trending-up"></i>
                    </div>
                    <div class="metric-content">
                        <div class="metric-label">Success Rate</div>
                        <div id="successRate" class="metric-value loading">0<span class="metric-unit">%</span></div>
                        <div id="successRateTrend" class="metric-trend">
                            <span class="trend-indicator">—</span>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Charts Section -->
            <section id="charts-card" class="card" style="--delay: 0.2s;">
                <div class="card-header">
                    <div>
                        <h2>Data Visualizations</h2>
                        <p>Interactive charts showing distribution patterns and trends across your proxy network</p>
                    </div>
                    <button id="toggleCharts" class="btn btn-secondary" aria-label="Toggle charts view">
                        <i data-feather="maximize-2"></i>
                        <span>Expand All</span>
                    </button>
                </div>

                <div id="chartsContainer" class="charts-grid">
                    <!-- Protocol Distribution -->
                    <div class="chart-wrapper">
                        <div class="chart-container">
                            <div class="chart-header">
                                <div>
                                    <h3>Protocol Distribution</h3>
                                    <p class="chart-desc">Breakdown of proxy protocols in the network</p>
                                </div>
                                <button class="chart-action" aria-label="Export chart data">
                                    <i data-feather="more-vertical"></i>
                                </button>
                            </div>
                            <canvas id="protocolChart" role="img" aria-label="Doughnut chart showing proxy protocol distribution"></canvas>
                        </div>
                    </div>

                    <!-- Geographic Distribution -->
                    <div class="chart-wrapper">
                        <div class="chart-container">
                            <div class="chart-header">
                                <div>
                                    <h3>Geographic Distribution</h3>
                                    <p class="chart-desc">Top 10 countries by proxy count</p>
                                </div>
                                <button class="chart-action" aria-label="Export chart data">
                                    <i data-feather="more-vertical"></i>
                                </button>
                            </div>
                            <canvas id="countryChart" role="img" aria-label="Bar chart showing top 10 countries with the most proxies"></canvas>
                        </div>
                    </div>

                    <!-- ASN Distribution -->
                    <div class="chart-wrapper">
                        <div class="chart-container">
                            <div class="chart-header">
                                <div>
                                    <h3>Network Providers</h3>
                                    <p class="chart-desc">Top autonomous systems hosting proxies</p>
                                </div>
                                <button class="chart-action" aria-label="Export chart data">
                                    <i data-feather="more-vertical"></i>
                                </button>
                            </div>
                            <canvas id="asnChart" role="img" aria-label="Bar chart showing top 10 ASNs with the most proxies"></canvas>
                        </div>
                    </div>

                    <!-- Time-series Analysis -->
                    <div class="chart-wrapper chart-full-width">
                        <div class="chart-container">
                            <div class="chart-header">
                                <div>
                                    <h3>Historical Performance</h3>
                                    <p class="chart-desc">Active proxy count trends over time</p>
                                </div>
                                <button class="chart-action" aria-label="Export chart data">
                                    <i data-feather="more-vertical"></i>
                                </button>
                            </div>
                            <canvas id="timeChart" role="img" aria-label="Line chart showing the number of working proxies over time"></canvas>
                        </div>
                    </div>
                </div>

                <div id="chartsEmptyState" class="empty-state hidden">
                    <div class="empty-state-icon">
                        <i data-feather="bar-chart-2"></i>
                    </div>
                    <h3>No Analytics Data Available</h3>
                    <p>We're currently collecting data to generate comprehensive analytics. Check back soon for detailed insights into your proxy network.</p>
                    <a href="index.html" class="btn btn-primary">
                        <i data-feather="home"></i>
                        <span>Return Home</span>
                    </a>
                </div>
            </section>

            <!-- Insights Section -->
            <section id="insights-section" class="insights-section" style="--delay: 0.3s;">
                <h2 class="section-title">
                    <i data-feather="lightbulb"></i>
                    <span>Network Insights</span>
                </h2>
                <div class="insights-grid">
                    <div class="insight-card">
                        <div class="insight-icon insight-icon-primary">
                            <i data-feather="shield"></i>
                        </div>
                        <h3>Network Health</h3>
                        <div id="networkHealthScore" class="insight-score loading">—</div>
                        <p id="networkHealthDesc" class="insight-desc">Calculating network reliability...</p>
                    </div>

                    <div class="insight-card">
                        <div class="insight-icon insight-icon-success">
                            <i data-feather="map-pin"></i>
                        </div>
                        <h3>Top Region</h3>
                        <div id="topRegion" class="insight-score loading">—</div>
                        <p id="topRegionDesc" class="insight-desc">Analyzing geographic distribution...</p>
                    </div>

                    <div class="insight-card">
                        <div class="insight-icon insight-icon-warning">
                            <i data-feather="trending-up"></i>
                        </div>
                        <h3>Best Protocol</h3>
                        <div id="bestProtocol" class="insight-score loading">—</div>
                        <p id="bestProtocolDesc" class="insight-desc">Evaluating protocol performance...</p>
                    </div>

                    <div class="insight-card">
                        <div class="insight-icon insight-icon-info">
                            <i data-feather="clock"></i>
                        </div>
                        <h3>Fastest Response</h3>
                        <div id="fastestLatency" class="insight-score loading">—</div>
                        <p id="fastestLatencyDesc" class="insight-desc">Measuring response times...</p>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <footer class="footer">
        <div class="container">
            <div class="social-links">
                <a href="https://github.com/AmirrezaFarnamTaheri/ConfigStream" target="_blank" rel="noopener noreferrer" aria-label="Visit our GitHub page"><i data-feather="github"></i></a>
                <a href="https://github.com/AmirrezaFarnamTaheri/ConfigStream/issues" target="_blank" rel="noopener noreferrer" aria-label="Report an issue"><i data-feather="alert-circle"></i></a>
            </div>
            <p>A passion project for a free and open internet. ✨</p>
            <p class="last-updated">Last updated: <span id="footerUpdate" class="loading">checking...</span></p>
        </div>
    </footer>

    <!-- CRITICAL: Load cache config FIRST -->
    <script src="assets/js/cache-config.js" defer></script>

    <!-- Then load other scripts -->
    <script src="assets/js/error-handler.js" defer></script>
    <script src="assets/js/state-manager.js" defer></script>
    <script src="assets/js/utils.js" defer></script>
    <script src="assets/js/cache-manager.js" defer></script>
    <script src="assets/js/loading-controller.js" defer></script>
    <script src="assets/js/logo-controller.js" defer></script>
    <script src="assets/js/main.js" defer></script>
    <script src="assets/js/statistics.js" defer></script>
    <script src="assets/js/inline-icons.js"></script>
</body>
</html>
